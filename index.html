<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>12 Week Year Tracker</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  max-width: 700px;
  margin: auto;
}
h1 { text-align: center; }
input, button, select {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
}
button { cursor: pointer; font-weight: bold; }
.done { background: #06d6a0; color: white; }
.partial { background: #ffd23f; }
.not { background: #ef476f; color: white; }
.card { border: 1px solid #ddd; padding: 12px; margin-bottom: 12px; }
</style>
</head>

<body>

<h1>12 Week Year Tracker</h1>

<select id="user">
  <option value="">Select name</option>
  <option>Aubrey</option>
  <option>Claire</option>
  <option>Carol</option>
  <option>Litty</option>
</select>

<select id="week">
  <script>
    for (let i=1;i<=12;i++) {
      document.write(`<option value="${i}">Week ${i}</option>`);
    }
  </script>
</select>

<div id="goals"></div>

<button onclick="submitWeek()">SUBMIT WEEK</button>

<script>
const WEB_APP_URL =
"https://script.google.com/macros/s/AKfycbwKRxrcj5XQ22IWZgCgYbpH7j9MnQNoRLLXrd05uaHp7Qfo0QZypC4TvL1qgN_1SuPoLA/exec";

const goalsDiv = document.getElementById("goals");

for (let g=1; g<=3; g++) {
  const d = document.createElement("div");
  d.className = "card";
  d.innerHTML = `
    <strong>Goal ${g}</strong>
    <input placeholder="Goal text">
    <input placeholder="Action">
    <button onclick="set(this,'done')" class="done">Done</button>
    <button onclick="set(this,'partial')" class="partial">Partial</button>
    <button onclick="set(this,'not')" class="not">Not Done</button>
  `;
  goalsDiv.appendChild(d);
}

function set(btn,status){
  btn.parentElement.dataset.status=status;
}

function submitWeek(){
  const user = document.getElementById("user").value;
  const week = Number(document.getElementById("week").value);
  if (!user) { alert("Pick a name"); return; }

  let total=0, possible=0;
  const goals=[];

  document.querySelectorAll(".card").forEach(c=>{
    const goal=c.querySelector("input").value;
    const action=c.querySelectorAll("input")[1].value;
    const status=c.dataset.status||"";
    if (action) {
      possible++;
      if (status==="done") total++;
      if (status==="partial") total+=0.5;
    }
    goals.push({goal,action,status});
  });

  const score = possible ? Math.round(total/possible*100) : 0;

  fetch(WEB_APP_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({userName:user,week,score,goals})
  });

  alert("Submitted");
}
</script>

</body>
</html>
